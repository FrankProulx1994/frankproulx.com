<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Calculatrice de R√©ponse Impulsive</title>
<style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            color: #333;
            line-height: 1.6;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 20px 10px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 28px;
        }
        header h2 {
            margin: 10px 0 0;
            font-size: 18px;
            font-style: italic;
        }
        header h3 {
            margin: 5px 0 0;
            font-size: 16px;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            margin: 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .yes-button {
            background-color: #28a745;
            color: white;
        }
        .yes-button:hover {
            background-color: #218838;
        }
        .no-button {
            background-color: #dc3545;
            color: white;
        }
        .no-button:hover {
            background-color: #c82333;
        }
        .hidden {
            display: none;
        }
        .positive-question {
            color: #d9534f; /* Rouge pour le tableau positif */
        }
        .negative-question {
            color: #000; /* Noir pour le tableau n√©gatif */
        }
        .result-header {
            font-weight: bold;
            font-size: 20px;
            margin-top: 20px;
            color: #007BFF; /* Bleu pour les r√©sultats */
        }
        .empty-space {
            margin: 20px 0;
        }
        .result-content p {
            margin: 8px 0;
            font-size: 16px;
            color: #0056b3; /* Texte des r√©sultats en bleu */
        }
        .result-content .emphasis {
            color: #d9534f;
            font-weight: bold;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        button {
            margin: 10px;
        }
        ul {
            list-style: none;
            padding: 0;
        }
        ul li {
            margin: 5px 0;
        }
        .precision {
            font-style: italic;
            color: #555;
        }
    
@media screen and (max-width: 600px) {
    body {
        font-size: 16px;
        padding: 10px;
    }
    .container {
        padding: 10px;
        margin: 10px;
        box-shadow: none;
        border-radius: 0;
    }
    input[type="text"] {
        width: 100% !important;
        font-size: 16px;
    }
    .button {
        width: 90%;
        margin: 10px auto;
        font-size: 16px;
    }
    canvas {
        max-width: 100% !important;
        height: auto !important;
    }
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0/dist/chartjs-plugin-annotation.min.js"></script>
</head>
<body>
<!-- Page de bienvenue -->
<div id="welcome-screen" style="text-align:center; padding: 100px;">
<h1>Bienvenue sur la Calculatrice de R√©ponse Impulsive</h1>
<p>La calculatrice de r√©ponse impulsive a √©t√© con√ßue comme un outil simple mais puissant pour vous aider √† r√©fl√©chir avant d'agir. Elle vous invite √† explorer une d√©cision, une action ou un choix en vous appuyant sur le mod√®le M.A.R.S. :
        Moi ‚Äì Autres ‚Äì Relation ‚Äì Situation.
        Ce mod√®le vous aide √† ralentir votre processus d√©cisionnel, √† prendre du recul et √† analyser la question que vous vous posez sous diff√©rents angles.</p>
<p>Indique ci-dessous l'action, la d√©cision ou le choix que tu veux explorer :</p>
<input id="userDecision" placeholder="Exemple : Frapper Jeff" style="padding:10px; width:80%; max-width:400px; font-size:16px; margin-bottom:20px;" type="text"/>
<p>Clique sur le bouton ci-dessous pour commencer.</p>
<h1>Comment √ßa fonctionne ?</h1>
<p>Choisissez une d√©cision, une action ou un choix que vous envisagez de faire.

        R√©pondez aux questions qui suivent. Celles-ci vous proposent uniquement des r√©ponses impulsives ‚Äì c‚Äôest volontaire. L‚Äôobjectif est de faire ressortir ce que vous pensez instinctivement dans l‚Äôinstant.
        
        √Ä la fin du questionnaire, des statistiques vous seront pr√©sent√©es. Elles vous permettront d‚Äôobserver quelles dimensions (Moi, Autres, Relation, Situation) influencent le plus vos r√©ponses impulsives.
        
        Si certaines validations sont rejet√©es, cela indique que vos r√©ponses sont incoh√©rentes ou confuses. Cela peut vouloir dire que vous √™tes m√©lang√© ou trop √©motif pour prendre une d√©cision claire. Dans ce cas, il est pr√©f√©rable de ne rien faire pour le moment et de refaire le test plus tard.
        
        Important :
        Cette calculatrice ne donne pas de r√©ponse magique ni de verdict final. Elle vous aide √† mieux comprendre vos r√©flexes et vos √©motions dans une situation donn√©e. Mieux se conna√Ætre, c‚Äôest d√©j√† avancer vers une d√©cision plus √©clair√©e.</p>
<button class="button yes-button" onclick="launchCalculator()">Commencer</button>
</div>
<!-- Page principale masqu√©e au d√©part -->
<div class="hidden" id="main-content">
<header>
<h1>Calculatrice de R√©ponse Impulsive</h1>
<h2>¬†</h2>
<h3>Bas√©e sur le mod√®le</h3>
<h3><strong>M.A.R.S</strong></h3>
</header>
<div class="container">
<div id="questions"></div>
<div style="text-align:center; margin-top: 20px;">
<button class="button yes-button" onclick="toggleDefinitions()">Afficher / Masquer les d√©finitions M.A.R.S.</button>
</div>
<div id="mars-definitions" style="display:none; margin-top:20px; padding:10px; background:#eef; border-radius:8px;">
<h3>D√©finitions du mod√®le M.A.R.S. :</h3>
<p><strong>Moi (M):</strong> Cette partie se concentre sur l'individu lui-m√™me, ses √©motions, ses pens√©es, ses besoins et ses peurs. Un article sur le site du Gouvernement du Qu√©bec explique que les personnes atteintes de TPL ont souvent une image n√©gative d'elles-m√™mes et peuvent avoir des difficult√©s √† r√©guler leurs √©motions.</p>
<p><strong>Autre (A):</strong> Cette section examine les autres personnes impliqu√©es dans la situation, y compris leurs √©motions, leurs motivations et leur fa√ßon de percevoir les choses. Un site d'information sur le TPL souligne que les relations interpersonnelles sont souvent difficiles pour les personnes atteintes de TPL.</p>
<p><strong>Relation (R):</strong> Ici, l'accent est mis sur la nature de la relation entre "Moi" et "Autre". Cela inclut la qualit√© de la communication, les attentes, les sch√©mas de comportement, et l'impact des √©motions de chacun sur la relation.</p>
<p><strong>Situation (S):</strong> Cette partie examine le contexte dans lequel la relation se d√©roule. Cela peut inclure des facteurs externes tels que le stress, les changements dans l'environnement ou des √©v√©nements sp√©cifiques qui peuvent influencer les √©motions et les comportements des personnes impliqu√©es.</p>
</div>
<div id="definition-box" style="background:#eef;padding:15px;margin-top:20px;border-radius:8px;display:none;font-size:0.95em;"></div>
<div class="hidden" id="results">
<div class="result-content" id="result-content"></div>
</div>
<div class="button-container">
<button class="button yes-button" onclick="restart()">Recommencer</button>
<button class="button no-button" onclick="window.print()">Imprimer</button>
</div>
</div>
</div>
<script>
    const elements = ['Situation', 'Relation', 'Autre(s)', 'Moi'];
    const values = [8, 4, 2, 1];
    let userDecision = "";
    let positiveOrder = [];
    let negativeOrder = [];
    let positiveImpacts = [];
    let negativeImpacts = [];
    let validationCount = 0;

    const questionsDiv = document.getElementById('questions');
    const resultsDiv = document.getElementById('results');
    const resultContentDiv = document.getElementById('result-content');

    function askImpact(type, order, callback) {
        questionsDiv.innerHTML = '';
        let index = 0;
        let impacts = [];
        function next() {
            if (index >= order.length) {
                callback(impacts);
                return;
            }
            const element = order[index];
            let htmlContent = `<h2 style="color:#007BFF;">Choix / D√©cision / Action : ${userDecision}</h2>` + `
                <h3 class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                    ${type === 'Positif' 
                        ? "Si tu choisis d'entreprendre cette action, d√©cision ou ce choix," 
                        : "Si tu choisis de ne pas entreprendre cette action, d√©cision ou ce choix,"}
                </h3>
                <p class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                    L'impact sur <span class="emphasis">${element}</span> est-il ${type === 'Positif' ? 'positif' : 'n√©gatif'} ?
                </p>
                <button class="button yes-button" onclick="recordImpact('o')">Oui</button>
                <button class="button no-button" onclick="recordImpact('n')">Non</button>
            `;
        questionsDiv.innerHTML = htmlContent;
        updateDefinitionFromText(htmlContent);
        }
        window.recordImpact = function (response) {
            impacts.push(response === 'o');
            index++;
            next();
        };
        next();
    }

    function validateOrder(order, type, callback) {
        let htmlContent = `<h2 style="color:#007BFF;">Choix / D√©cision / Action : ${userDecision}</h2>` + `
            <h3 class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                ${type === 'Positif' 
                    ? "Si tu choisis d'entreprendre cette action, d√©cision ou ce choix," 
                    : "Si tu choisis de ne pas entreprendre cette action, d√©cision ou ce choix,"}
            </h3>
            <p class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                Ordre d√©termin√© (${type}) : <span class="emphasis">${order.join(', ')}</span>
            </p>
            <p class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                L'ordre indiqu√© est-il correct ?
            </p>
            <button class="button yes-button" onclick="validationResponse(true)">Oui</button>
            <button class="button no-button" onclick="validationResponse(false)">Non</button>
        `;
        questionsDiv.innerHTML = htmlContent;
        updateDefinitionFromText(htmlContent);
        window.validationResponse = function (valid) {
            if (!valid) validationCount++;
            callback(valid);
        };
    }

    function sortElements(elements, type, callback) {
        let order = [elements[0]];
        let index = 1;
        function next() {
            if (index >= elements.length) {
                validateOrder(order, type, (valid) => {
                    if (valid) {
                        callback(order);
                    } else {
                        sortElements(elements, type, callback);
                    }
                });
                return;
            }
            const current = elements[index];
            let position = 0;
            function compare() {
                if (position >= order.length) {
                    order.push(current);
                    index++;
                    next();
                    return;
                }
                const reference = order[position];
                let htmlContent = `<h2 style="color:#007BFF;">Choix / D√©cision / Action : ${userDecision}</h2>` + `
                    <h3 class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                        ${type === 'Positif' 
                            ? "Si tu choisis d'entreprendre cette action, d√©cision ou ce choix," 
                            : "Si tu choisis de ne pas entreprendre cette action, d√©cision ou ce choix,"}
                    </h3>
                    <p class="${type === 'Positif' ? 'positive-question' : 'negative-question'}">
                        L'impact de <span class="emphasis">${current}</span> est-il plus important que celui de <span class="emphasis">${reference}</span> ?
                    </p>
                    <button class="button yes-button" onclick="compareResponse(true)">Oui</button>
                    <button class="button no-button" onclick="compareResponse(false)">Non</button>
                `;
        questionsDiv.innerHTML = htmlContent;
        updateDefinitionFromText(htmlContent);
            }
            window.compareResponse = function (higher) {
                if (higher) {
                    order.splice(position, 0, current);
                    index++;
                    next();
                } else {
                    position++;
                    compare();
                }
            };
            compare();
        }
        next();
    }

    function calculateResults() {
        let total = 15;
        let positiveValues = [];
        let negativeValues = [];
        let detailedPositive = [];
        let detailedNegative = [];

        positiveOrder.forEach((el, i) => {
            if (positiveImpacts[i]) {
                let value = values[i];
                let percentage = Math.round((value / total) * 100);
                positiveValues.push(value);
                detailedPositive.push({ element: el, percentage });
            }
        });

        negativeOrder.forEach((el, i) => {
            if (negativeImpacts[i]) {
                let value = values[i];
                let percentage = Math.round((value / total) * 100);
                negativeValues.push(value);
                detailedNegative.push({ element: el, percentage });
            }
        });

        detailedPositive.sort((a, b) => b.percentage - a.percentage);
        detailedNegative.sort((a, b) => b.percentage - a.percentage);

        let totalPositive = positiveValues.reduce((a, b) => a + b, 0);
        let totalNegative = negativeValues.reduce((a, b) => a + b, 0);

        let percentPositive = Math.round((totalPositive / total) * 100);
        let percentNegative = Math.round((totalNegative / total) * 100);
        let scorePositive = Math.round((totalPositive / total) * 10);
        let scoreNegative = Math.round((totalNegative / total) * 10);
        let globalScore = Math.round((scorePositive + scoreNegative) / 2);

        let positiveDetailsHTML = detailedPositive.length > 0 
            ? `<div class="precision">Pr√©cision :</div><ul>` + 
              detailedPositive.map((item) => `<li>${item.element} : ${item.percentage}%</li>`).join('') + `</ul>`
            : `<p>Aucune pr√©cision</p>`;
        
        let negativeDetailsHTML = detailedNegative.length > 0 
            ? `<div class="precision">Pr√©cision :</div><ul>` + 
              detailedNegative.map((item) => `<li>${item.element} : ${item.percentage}%</li>`).join('') + `</ul>`
            : `<p>Aucune pr√©cision</p>`;

        
        resultContentDiv.innerHTML = `
            <div class="result-header">Choix / D√©cision / Action :</div>
            <p style="font-weight:bold; font-size:18px; color:#333;">${userDecision}</p>
            <div class="empty-space"></div>

            <div class="result-header">R√©sultat global :</div>
<p class='precision'>Note finale repr√©sentant √† quel point tu crois que cette d√©cision est bonne.</p>
            <p>Score global : ${globalScore} / 10 (${globalScore * 10}%)</p>
            <div class="empty-space"></div>

            <div class="result-header">Tableau positif :</div>
<p class='precision'>Facteurs qui font pencher la balance en faveur de faire cette action, ce choix ou cette d√©cision.</p>
            <p>Score positif sur : ${scorePositive} / 10 soit ${percentPositive}%</p>
            ${positiveDetailsHTML}
            <div class="empty-space"></div>

            <div class="result-header">Tableau n√©gatif :</div>
<p class='precision'>Facteurs qui font pencher la balance en faveur de ne pas faire cette action, ce choix ou cette d√©cision.</p>
            <p>Score n√©gatif sur : ${scoreNegative} / 10 soit ${percentNegative}%</p>
            ${negativeDetailsHTML}
            <div class="empty-space"></div>
            <p class="emphasis">√Ä faire attention</p>
            <div class="empty-space"></div>

            <p>Nombre de validations rejet√©es : ${validationCount}</p>
<div class='result-header'>‚ö†Ô∏è Nombre de validations rejet√©es :</div>
<p>Indique un niveau de confusion ou d‚Äôambivalence dans tes r√©ponses.<br>Si ce nombre est sup√©rieur √† 0, il est pr√©f√©rable d‚Äôattendre avant de prendre une d√©cision et de refaire le test plus tard, dans un √©tat plus calme ou plus clair.</p>

        
            <div class="result-header">Graphique des impacts positifs :</div>
<p class='precision'>Montre ce qui affaiblit ou d√©savantage la balance si tu choisis de faire cette action, ce choix ou cette d√©cision. Bas√© uniquement sur les √©l√©ments jug√©s n√©gatifs (r√©ponses &laquo; NON &raquo;).</p>
            <canvas id="positiveChart" width="400" height="300"></canvas>
            <div class="empty-space"></div>

            <div class="result-header">Graphique des impacts n√©gatifs :</div>
<p class='precision'>Montre ce qui affaiblit ou d√©savantage la balance si tu choisis de ne pas faire cette action, ce choix ou cette d√©cision. Bas√© uniquement sur les √©l√©ments jug√©s n√©gatifs (r√©ponses &laquo; NON &raquo;).</p>
            <canvas id="negativeChart" width="400" height="300"></canvas>
            <div class="empty-space"></div>
`;
        questionsDiv.innerHTML = '';
        const defBox = document.getElementById('definition-box');
if (defBox) {
  defBox.innerHTML = '';
  defBox.style.display = 'none';
}
resultsDiv.classList.remove('hidden');
        // Cr√©ation des graphiques
        const ctxPos = document.getElementById('positiveChart').getContext('2d');
        const ctxNeg = document.getElementById('negativeChart').getContext('2d');

        const positiveLabels = positiveOrder
            .map((el, i) => !positiveImpacts[i] ? el.charAt(0) : null)
            .filter(Boolean);
        const positiveData = positiveOrder
            .map((el, i) => !positiveImpacts[i] ? Math.round((values[i] / total) * 100) : null)
            .filter(val => val !== null);

        const negativeLabels = negativeOrder
            .map((el, i) => !negativeImpacts[i] ? el.charAt(0) : null)
            .filter(Boolean);
        const negativeData = negativeOrder
            .map((el, i) => !negativeImpacts[i] ? Math.round((values[i] / total) * 100) : null)
            .filter(val => val !== null);

        Chart.register(window['chartjs-plugin-annotation']);
new Chart(ctxPos, {
            type: 'bar',
            data: {
                labels: positiveLabels,
                datasets: [{
                    label: '% Impact positif',
                    data: positiveData,
                    backgroundColor: '#28a745'
                }]
            },
            
            options: {

                plugins: {
                    annotation: {
                        annotations: {
                            faible: {
                                type: 'box',
                                yMin: 0,
                                yMax: 7,
                                backgroundColor: 'rgba(255, 0, 0, 0.1)'
                            },
                            normal: {
                                type: 'box',
                                yMin: 7,
                                yMax: 13,
                                backgroundColor: 'rgba(255, 165, 0, 0.1)'
                            },
                            important: {
                                type: 'box',
                                yMin: 13,
                                yMax: 27,
                                backgroundColor: 'rgba(255, 255, 0, 0.1)'
                            },
                            tresImportant: {
                                type: 'box',
                                yMin: 27,
                                yMax: 53,
                                backgroundColor: 'rgba(0, 128, 0, 0.1)'
                            }
                        }
                    }
                },

                indexAxis: 'x',
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 53
                    },
                    x: {
                        ticks: { font: { size: 14 } }
                    }
                }
            }

        });

        Chart.register(window['chartjs-plugin-annotation']);
new Chart(ctxNeg, {
            type: 'bar',
            data: {
                labels: negativeLabels,
                datasets: [{
                    label: '% Impact n√©gatif',
                    data: negativeData,
                    backgroundColor: '#dc3545'
                }]
            },
            
            options: {

                plugins: {
                    annotation: {
                        annotations: {
                            faible: {
                                type: 'box',
                                yMin: 0,
                                yMax: 7,
                                backgroundColor: 'rgba(255, 0, 0, 0.1)'
                            },
                            normal: {
                                type: 'box',
                                yMin: 7,
                                yMax: 13,
                                backgroundColor: 'rgba(255, 165, 0, 0.1)'
                            },
                            important: {
                                type: 'box',
                                yMin: 13,
                                yMax: 27,
                                backgroundColor: 'rgba(255, 255, 0, 0.1)'
                            },
                            tresImportant: {
                                type: 'box',
                                yMin: 27,
                                yMax: 53,
                                backgroundColor: 'rgba(0, 128, 0, 0.1)'
                            }
                        }
                    }
                },

                indexAxis: 'x',
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 53
                    },
                    x: {
                        ticks: { font: { size: 14 } }
                    }
                }
            }

        });

    }

    function restart() {
    window.location.href = 'https://frankproulx.com';
        
    }

    function start() {
        sortElements(elements, 'Positif', (order) => {
            positiveOrder = order;
            askImpact('Positif', positiveOrder, (impacts) => {
                positiveImpacts = impacts;
                sortElements(elements, 'N√©gatif', (order) => {
                    negativeOrder = order;
                    askImpact('N√©gatif', negativeOrder, (impacts) => {
                        negativeImpacts = impacts;
                        calculateResults();
                    });
                });
            });
        });
    }

    

    function launchCalculator() {
        const input = document.getElementById("userDecision").value.trim();
        userDecision = input || "(non pr√©cis√©)";
        document.getElementById("welcome-screen").style.display = "none";
        document.getElementById("main-content").classList.remove("hidden");
        start();
    }
</script>
</div>
<script>
function updateDefinitionFromText(text) {
  const resultsVisible = !document.getElementById("results").classList.contains("hidden");
  const box = document.getElementById("definition-box");
  if (resultsVisible) {
    if (box) { box.innerHTML = ""; box.style.display = "none"; }
    return;
  }
  const defs = {
    "Moi": "üí≠ <strong>Moi (M):</strong> Se concentre sur toi-m√™me : √©motions, pens√©es, besoins et peurs.",
    "Autre": "üë• <strong>Autre (A):</strong> Porte sur les autres : √©motions, motivations et perceptions.",
    "Relation": "üîó <strong>Relation (R):</strong> Nature de la relation entre Moi et Autre : communication, attentes, comportements.",
    "Situation": "üåç <strong>Situation (S):</strong> Contexte de la relation : environnement, stress ou √©v√©nements."
  };
  let found = Object.entries(defs).filter(([key]) => text.includes(key)).map(([, v]) => v).join("<br><br>");
  if (found) {
    box.innerHTML = found;
    box.style.display = "block";
  } else {
    box.innerHTML = "";
    box.style.display = "none";
  }
}
</script>
<script>
function toggleDefinitions() {
    const defBlock = document.getElementById("mars-definitions");
    if (defBlock) {
        defBlock.style.display = defBlock.style.display === "none" ? "block" : "none";
    }
}
</script></body>
</html>
